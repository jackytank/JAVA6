<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/index :: dynamic(~{::section})}">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- bootstrap css -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
</head>

<body>
    <section class="bg-white" ng-controller="user-ctrl">
        <div class="container py-2">
            <div class="row d-flex justify-content-center align-content-start align-items-center">
                <div class="col-12 col-md-8 col-lg-8 col-xl-6">
                    <div class="card rounded-4 shadow">
                        <div class="card-body p-md-5 p-sm-2">
                            <h2 class="fw-bold mb-4">Edit profile</h2>
                            <form th:object="${user}" class="needs-validation" novalidate="true">
                                <div class="">
                                    <input type="hidden" ng-model="form.id" th:field="*{id}">
                                    <div class="mb-3">
                                        <label for="image" class="mb-2">
                                            <img ng-src="{{ (form.image_url.startsWith('upload')?'/upload/images/':'/assets/images/') + (form.image_url || 'default-user.jpg') }}"
                                                style="max-width: 20vw; max-height: 20vh;" alt="User image">
                                        </label>
                                        <input ng-model="form.image_url" type="file" class="form-control form-control-sm" id="image"
                                            onchange="angular.element(this).scope().imageChanged(this.files)">
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-floating">
                                            <input ng-model="form.username" th:field="*{username}" type="text" id="floatingUsername"
                                                class="form-control rounded-3" required="required" placeholder="Username" />
                                            <label for="floatingUsername">Username</label>
                                            <div class="invalid-feedback">Please enter a valid username.</div>
                                        </div>
                                    </div>
                                    <div class="mb-3  ">
                                        <div class="form-floating">
                                            <input ng-model="form.email" type="email" th:field="*{email}" id="floatingEmail" class="form-control rounded-3"
                                                required="required" placeholder="name@example.com" />
                                            <label for="floatingEmail">E-mail: </label>
                                            <div class="invalid-feedback">Please enter a valid email.</div>
                                        </div>
                                    </div>
                                    <div class="mb-3  ">
                                        <div class="form-floating">
                                            <input ng-model="form.phone" type="tel" th:field="*{phone}" id="floatingPhone" class="form-control rounded-3"
                                                required="required" placeholder="0xxxxxxxxx" pattern="(\+84|0)\d{9,10}" />
                                            <label for="floatingPhone">Phone: </label>
                                            <div class="invalid-feedback">Please enter a valid phone.</div>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="mb-3  ">
                                        <div class="form-floating">
                                            <input ng-model="form.password" type="password" id="password" th:field="*{password}" class="form-control  rounded-3"
                                                required="required" minlength="6" maxlength="10" placeholder="Password" />
                                            <label for="password">Password: </label>
                                            <div class="invalid-feedback">Please enter a valid password.</div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-floating">
                                            <input type="password" id="floatingRetype" class="form-control  rounded-3" required="required" minlength="6"
                                                maxlength="10" oninput="checkPasswordMatch(this);" placeholder="Retype" />
                                            <label for="floatingRetype">Retype: </label>
                                            <div class="invalid-feedback">Please enter a valid retype.</div>
                                        </div>
                                    </div>
                                    <div class="d-grid gap-2 mb-2">
                                        <button ng-disabled="myform.$invalid" ng-click="update()" type="submit" id="submit"
                                            class="btn btn-lg rounded-3 btn-primary">Update</button>
                                    </div>
                                    <h4 class="text-danger mb-2">{{message}}</h4>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>

</html>